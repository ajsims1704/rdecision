<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew J. Sims" />

<meta name="date" content="2019-09-17" />

<title>Example Markov Model By Sonnenberg and Beck</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example Markov Model By Sonnenberg and Beck</h1>
<h3 class="subtitle">Monte-Carlo / Discrete Event Simulation</h3>
<h4 class="author">Andrew J. Sims</h4>
<h4 class="date">2019-09-17</h4>



<pre><code>#&gt; 
#&gt; Attaching package: &#39;rdecision&#39;
#&gt; The following objects are masked _by_ &#39;.GlobalEnv&#39;:
#&gt; 
#&gt;     MarkovModel, MarkovState</code></pre>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The vignette is an example of solving a three-state Markov model using a Monte-Carlo, or discrete event simulation, approach. The example is provided by Sonnenberg and Beck <span class="citation">(1993)</span> in their Figure 3 and Table 1.</p>
</div>
<div id="model-construction" class="section level1">
<h1>Model construction</h1>
<p>The model is designed with a data frame, <code>states</code>, describing the three states, the initial prevalance in each state, and the transition matrix (<code>incidence</code>). There are no time-limited states and that matrix is filled with zeros.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># model parameters</span></a>
<a class="sourceLine" id="cb2-2" title="2">nStates &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb2-3" title="3">state &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">name =</span> <span class="kw">c</span>(<span class="st">&quot;Well&quot;</span>, <span class="st">&quot;Disabled&quot;</span>, <span class="st">&quot;Dead&quot;</span>),</a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="dt">hasCycleLimit =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="dt">cycleLimit =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="dt">annualCost =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="dt">entryCost =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="dt">utility =</span> <span class="kw">c</span>(<span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.0</span>),</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="dt">group =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-11" title="11">)</a>
<a class="sourceLine" id="cb2-12" title="12">prevalence &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>)</a>
<a class="sourceLine" id="cb2-13" title="13">incidence &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">c</span>(<span class="ot">NA</span>,  <span class="fl">0.2</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb2-14" title="14">                      <span class="kw">c</span>(<span class="fl">0.0</span>,  <span class="ot">NA</span>, <span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb2-15" title="15">                      <span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>,  <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb2-16" title="16">                    <span class="dt">nrow=</span>nStates, <span class="dt">byrow=</span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb2-17" title="17">)</a>
<a class="sourceLine" id="cb2-18" title="18">Tp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>, nStates<span class="op">*</span>nStates), <span class="dt">nrow=</span>nStates, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-19" title="19">discount &lt;-<span class="st"> </span><span class="fl">0.0</span></a></code></pre></div>
<p>The parameters of the simulation are defined as follows, to replicate the results of Sonneberg and Beck <span class="citation">(1993, Table 2)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># simulation parameters</span></a>
<a class="sourceLine" id="cb3-2" title="2">nPatients &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb3-3" title="3">nCyclesPerYear &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-4" title="4">nYears &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb3-5" title="5">nCycles &lt;-<span class="st"> </span>nYears<span class="op">*</span>nCyclesPerYear</a></code></pre></div>
</div>
<div id="running-the-model" class="section level1">
<h1>Running the model</h1>
<p>The following call runs the model for 24 cycles (24 years).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># solve the model using Monte-Carlo method...</span></a>
<a class="sourceLine" id="cb4-2" title="2">ms &lt;-<span class="st"> </span><span class="kw">des</span>(<span class="dt">nStates=</span>nStates, </a>
<a class="sourceLine" id="cb4-3" title="3">          <span class="dt">nGroups =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">          <span class="dt">nPatients =</span> nPatients,</a>
<a class="sourceLine" id="cb4-5" title="5">          <span class="dt">nCyclesPerYear =</span> nCyclesPerYear, </a>
<a class="sourceLine" id="cb4-6" title="6">          <span class="dt">nCycles =</span> nCycles,</a>
<a class="sourceLine" id="cb4-7" title="7">          <span class="dt">state =</span> state, </a>
<a class="sourceLine" id="cb4-8" title="8">          <span class="dt">group =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb4-9" title="9">          <span class="dt">prevalence =</span> prevalence, </a>
<a class="sourceLine" id="cb4-10" title="10">          <span class="dt">Ip =</span> incidence, </a>
<a class="sourceLine" id="cb4-11" title="11">          <span class="dt">Tp =</span> Tp, </a>
<a class="sourceLine" id="cb4-12" title="12">          <span class="dt">Gp =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb4-13" title="13">          <span class="dt">discount =</span> discount,</a>
<a class="sourceLine" id="cb4-14" title="14">          <span class="dt">stub=</span><span class="ot">NA</span>)</a></code></pre></div>
<p>The summary output from the model is in the following table. Note that the results differ slighly from Sonnenberg and Beck’s Table 2, because the model has been solved using discrete event simulation, and half-cycle correction has been applied.</p>
<table>
<thead>
<tr class="header">
<th align="right">Cycle</th>
<th align="right">Well</th>
<th align="right">Disabled</th>
<th align="right">Dead</th>
<th align="right">Total</th>
<th align="right">Utility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">7968.5</td>
<td align="right">1006.0</td>
<td align="right">1025.5</td>
<td align="right">10000</td>
<td align="right">8672.70</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4756.5</td>
<td align="right">2223.0</td>
<td align="right">3020.5</td>
<td align="right">10000</td>
<td align="right">14985.30</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2847.5</td>
<td align="right">2303.0</td>
<td align="right">4849.5</td>
<td align="right">10000</td>
<td align="right">19444.90</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1679.5</td>
<td align="right">1953.5</td>
<td align="right">6367.0</td>
<td align="right">10000</td>
<td align="right">22491.85</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">988.5</td>
<td align="right">1502.0</td>
<td align="right">7509.5</td>
<td align="right">10000</td>
<td align="right">24531.75</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">600.5</td>
<td align="right">1079.0</td>
<td align="right">8320.5</td>
<td align="right">10000</td>
<td align="right">25887.55</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">371.5</td>
<td align="right">758.0</td>
<td align="right">8870.5</td>
<td align="right">10000</td>
<td align="right">26789.65</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">229.5</td>
<td align="right">521.5</td>
<td align="right">9249.0</td>
<td align="right">10000</td>
<td align="right">27384.20</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">134.5</td>
<td align="right">351.5</td>
<td align="right">9514.0</td>
<td align="right">10000</td>
<td align="right">27764.75</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">68.5</td>
<td align="right">242.0</td>
<td align="right">9689.5</td>
<td align="right">10000</td>
<td align="right">28002.65</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">36.0</td>
<td align="right">165.5</td>
<td align="right">9798.5</td>
<td align="right">10000</td>
<td align="right">28154.50</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">19.0</td>
<td align="right">110.0</td>
<td align="right">9871.0</td>
<td align="right">10000</td>
<td align="right">28250.50</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">10.5</td>
<td align="right">75.5</td>
<td align="right">9914.0</td>
<td align="right">10000</td>
<td align="right">28313.85</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">4.5</td>
<td align="right">49.0</td>
<td align="right">9946.5</td>
<td align="right">10000</td>
<td align="right">28352.65</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">2.0</td>
<td align="right">27.0</td>
<td align="right">9971.0</td>
<td align="right">10000</td>
<td align="right">28373.55</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">1.5</td>
<td align="right">17.0</td>
<td align="right">9981.5</td>
<td align="right">10000</td>
<td align="right">28386.95</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">1.0</td>
<td align="right">10.5</td>
<td align="right">9988.5</td>
<td align="right">10000</td>
<td align="right">28395.30</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">1.0</td>
<td align="right">5.5</td>
<td align="right">9993.5</td>
<td align="right">10000</td>
<td align="right">28400.15</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.5</td>
<td align="right">2.0</td>
<td align="right">9997.5</td>
<td align="right">10000</td>
<td align="right">28402.05</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">9999.0</td>
<td align="right">10000</td>
<td align="right">28402.75</td>
</tr>
<tr class="odd">
<td align="right">21</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">9999.0</td>
<td align="right">10000</td>
<td align="right">28403.45</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">9999.0</td>
<td align="right">10000</td>
<td align="right">28404.15</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">9999.0</td>
<td align="right">10000</td>
<td align="right">28404.85</td>
</tr>
<tr class="even">
<td align="right">24</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">9999.0</td>
<td align="right">10000</td>
<td align="right">28405.55</td>
</tr>
</tbody>
</table>
<div id="refs" class="references">
<div id="ref-sonnenberg:1993a">
<p>Sonnenberg, Frank A., and J. Robert Beck. 1993. “Markov Models in Medical Decision Making: A Practical Guide.” <em>Medical Decision Making</em>. <a href="https://doi.org/10.1177/0272989X9301300409">https://doi.org/10.1177/0272989X9301300409</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
