---
title: "Surgical sutures"
subtitle: "A decision tree example"
author: "Andrew J. Sims"
date: "February 2021"
output: rmarkdown::pdf_document
vignette: >
  %\VignetteIndexEntry{Surgical sutures}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: "references.bib"
csl: "bmj.csl"
---
```{r, include = FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo=F}
library(rdecision)
```

# Introduction
Leaper *et al* [-@leaper2017] presented a model that compared antimicrobial
surgical sutures (absorbable sutures impregnated with triclosan, TCS) with
standard care, absorbable sutures with no antimicrobial impregnation (NCS). 
The model was evaluated in three scenarios:

* clean wounds;
* clean-contaminated wounds;
* contaminated and dirty wounds




# The model

## Model variables
The model had six input variables:

* the probability of an SSI with NCS
* the risk ratio of an SSI with TCS compared with NCS
* cost of TCS
* cost of NCS
* number of sutures per surgical procedure
* cost of an admission with diagnosis of infection.

The two probabilities were specific to each model scenario.

```{r modvars}
# model inputs
c.pack.TCS <- 3.63    # MIB: VICRYL plus
c.pack.NCS <- 2.88   # MIB: VICRYL
n.sutures <- 2        # no data in paper or MIB
p.SSI.NCS <- 0.10     # Coello, reported by Leaper
rr.TCS <- 0.67        # Reported by Leaper, from 1 meta analysis
c.SSI <- 3000.0       # excess cost (direct + LoS of an SSI)

# derived parameters (expressions)
q.SSI.NCS <- 1 - p.SSI.NCS
p.SSI.TCS <- p.SSI.NCS * rr.TCS
q.SSI.TCS  <- 1 - p.SSI.TCS
c.TCS <- c.pack.TCS * n.sutures
c.NCS <- c.pack.NCS * n.sutures
```


## Model structure
```{r model}
# nodes
A <- LeafNode$new("A")
B <- LeafNode$new("B")
c1 <- ChanceNode$new()
C <- LeafNode$new("C")
D <- LeafNode$new("D")
c2 <- ChanceNode$new()
d1 <- DecisionNode$new("Suture")
# edges
E <- list(
  Reaction$new(c1,A,p=p.SSI.TCS,cost=c.SSI,label="SSI"),
  Reaction$new(c1,B,p=q.SSI.TCS,cost=0,label="No SSI"),
  Action$new(d1,c1,label="Antimicrobial",cost=c.TCS,benefit=0),
  Reaction$new(c2,C,p=p.SSI.NCS,cost=c.SSI,label="SSI"),
  Reaction$new(c2,D,p=q.SSI.NCS,cost=0,label="No SSI"),
  Action$new(d1,c2,label="Non-antimicrobial",cost=c.NCS,benefit=0)
)
DT <- DecisionTree$new(V = list(A,B,c1,C,D,c2,d1),E)
```
The decision tree defined by Leaper *et al* [-@leaper2017] is shown in the
figure below. The same tree was used to evaluate the choice of suture type
for several scenarios.
```{r draw, fig.keep="last", fig.align="center", fig.width=6}
DT$draw()
```

# Results

```{r base-case}
RES <- DT$evaluate()
pander::pander(RES)
```



# References

